(function(){let threatDetected=false;const config={crashPage:typeof crashPage!=="undefined"?crashPage:false,blockedExtensions:typeof blockedExtensions!=="undefined"?blockedExtensions.filter(id=>id&&typeof id==="string"):[],redirectURL:typeof redirectURL!=="undefined"?redirectURL:"",baseDomain:typeof baseDomain!=="undefined"?baseDomain:window.location.hostname.replace("www.",""),antiCloneDomain:typeof antiCloneDomain!=="undefined"?antiCloneDomain:"",timeBeforeReplace:typeof timeBeforeReplace!=="undefined"?timeBeforeReplace:3e5};function triggerAction(reason){if(threatDetected)return;threatDetected=true;if(config.crashPage){console.error("DR-Shield: Modo Agressivo ativado. Travando a aba do navegador...");if(typeof devtoolsDetector!=="undefined"){devtoolsDetector.crashBrowser()}}else{console.warn(`DR-Shield: Modo Sutil ativado. Redirecionando o usuário...`);if(config.redirectURL){window.location.href=config.redirectURL}else{window.open("","_self").close()}}}function inspectInjectedNode(node){if(node.nodeType!==1)return;const source=node.src||"";if(!source||config.blockedExtensions.length===0)return;for(const id of config.blockedExtensions){try{const idRegex=new RegExp(id.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));if(idRegex.test(source)){triggerAction(`Injeção detectada contendo o ID bloqueado: ${id}`);break}}catch(e){console.error(`DR-Shield: ID de extensão inválido para Regex: ${id}`,e)}}}function initializeInjectionObserver(){const observer=new MutationObserver(mutations=>{for(const mutation of mutations){for(const node of mutation.addedNodes){inspectInjectedNode(node)}}});observer.observe(document.documentElement,{childList:true,subtree:true})}function detectDevTools(){if(typeof devtoolsDetector==="undefined"){console.error("DR-Shield: Biblioteca 'devtools-detector' não encontrada.");return}devtoolsDetector.addListener(isOpen=>{if(isOpen){triggerAction("DevTools aberto pelo usuário")}});devtoolsDetector.launch()}function setupAntiCopy(){document.oncontextmenu=()=>false;document.onselectstart=()=>false;window.onkeydown=e=>{if((e.ctrlKey||e.metaKey)&&["c","u","s","i","p","a"].includes(e.key.toLowerCase()))e.preventDefault();if(["F12","F5"].includes(e.key))e.preventDefault()}}function activateAntiClone(){const currentHostname=window.location.hostname.replace("www.","");if(config.baseDomain&&currentHostname!==config.baseDomain){setTimeout(()=>{if(!config.antiCloneDomain)return;document.querySelectorAll("a").forEach(link=>link.href=config.antiCloneDomain);console.log("DR-Shield: Sistema anti-clone ativado. Links substituídos.")},config.timeBeforeReplace)}}function initializeShield(){if(window.self!==window.top)return;console.log("DR-Shield v3.0 ativado.");setupAntiCopy();detectDevTools();initializeInjectionObserver();activateAntiClone()}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",initializeShield)}else{initializeShield()}})();